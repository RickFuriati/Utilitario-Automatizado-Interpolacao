# Atualiza os pacotes e instala dependências necessárias para compilar GDAL
sudo apt update
sudo apt install -y build-essential git curl \
    python3-dev python3-pip python3-setuptools python3-wheel \
    libproj-dev proj-data proj-bin \
    libgeos-dev libgeos++-dev \
    libsqlite3-dev \
    libtiff-dev libjpeg-dev libpng-dev \
    libcurl4-openssl-dev libxml2-dev \
    libexpat1-dev zlib1g-dev

# Baixa e extrai o código-fonte do GDAL
wget https://github.com/OSGeo/gdal/releases/download/v3.8.5/gdal-3.8.5.tar.gz
tar -xzf gdal-3.8.5.tar.gz
cd gdal-3.8.5

# Configura e compila o GDAL
./configure --prefix=/usr/local
make -j$(nproc)
sudo make install

# Atualiza os links das bibliotecas do sistema
sudo ldconfig

# Define variáveis de ambiente para a instalação do binding Python
export CPLUS_INCLUDE_PATH=/usr/local/include
export C_INCLUDE_PATH=/usr/local/include
export LD_LIBRARY_PATH=/usr/local/lib
export GDAL_VERSION="3.8.5"

# Instala o binding Python do GDAL compilado
pip install --no-binary=gdal GDAL==$GDAL_VERSION
